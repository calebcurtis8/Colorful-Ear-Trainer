(self.webpackChunk=self.webpackChunk||[]).push([[826],{6226:(t,e,s)=>{var i,n;void 0===(n="function"==typeof(i=function(){const t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"];class e extends HTMLElement{constructor(){super(),this.root=this.attachShadow({mode:"open"}),this.root.addEventListener("mousedown",(t=>{this.handleClick(t,!0),t.preventDefault()})),this.root.addEventListener("mouseup",(t=>{this.handleClick(t,!1),t.preventDefault()})),this.root.addEventListener("mouseout",(t=>{this.handleClick(t,!1),t.preventDefault()})),this.root.innerHTML=`<style>${this.getCss()}</style><div>${this.getNoteSvg()}`}static get observedAttributes(){return["key-count","keyboard-layout","read-only"]}get config(){return{keyCount:parseInt(this.getAttribute("key-count")||"88"),keyboardLayout:this.getAttribute("keyboard-layout")||"A",readOnly:this.hasAttribute("read-only")}}connectedCallback(){}attributeChangedCallback(){this.root.innerHTML=`<style>${this.getCss()}</style><div>${this.getNoteSvg()}</div>`}handleClick(t,e){if(this.config.readOnly)return;const s=t.target;if("rect"===s.tagName){const i=t.target.getAttribute("data-note"),n=parseInt(t.target.getAttribute("data-octave"));e?(this.setNoteDown(i,n),this.dispatchEvent(new CustomEvent("note-down",{detail:{note:i,octave:n}}))):s.hasAttribute("data-depressed")&&(this.setNoteUp(i,n),this.dispatchEvent(new CustomEvent("note-up",{detail:{note:i,octave:n}})))}}setNoteDown(t,e){const i=this.root.querySelector(s(t,e));i.classList.add("depressed"),i.setAttribute("data-depressed","data-depressed")}setNoteUp(t,e){const i=this.root.querySelector(s(t,e));i.classList.remove("depressed"),i.removeAttribute("data-depressed")}getNoteSvg(){const e=this.config.keyCount,s=function*(e){const s=t.indexOf(e),i=[...t.slice(s,t.length),...t.slice(0,s)];let n=0,a=!0;for(;;)for(let t=0;t<i.length;t++){const e=i[t];"C"!==e||a||(n+=1),yield{name:e,octave:n},a=!1}}(this.config.keyboardLayout),i=new Array(e).fill(1).map((()=>s.next().value));return`<svg viewBox="0 0 ${10*i.filter((t=>!t.name.includes("#"))).length+(i[i.length-1].name.includes("#")?3:0)+2} 52" version="1.1" xmlns="http://www.w3.org/2000/svg">\n            ${this.getKeysForNotes(i)}\n        </svg>`}getKeysForNotes(t){let e=-9;const s=t.map((t=>{let s=0;return t.name.includes("#")?s=e+7:(e+=10,s=e),{note:t.name,octave:t.octave,offset:s}}));return`<g>\n            ${s.filter((t=>!t.note.includes("#"))).map((t=>{return e=t.note,s=t.octave,i=t.offset,`<rect class="natural-note note" data-note="${e}" data-octave="${s}" x=${i} y=1></rect>`;var e,s,i}))}\n            ${s.filter((t=>t.note.includes("#"))).map((t=>{return e=t.note,s=t.octave,i=t.offset,`<rect class="sharp-note note" data-note="${e}" data-octave="${s}" x=${i} y=1></rect>`;var e,s,i}))}\n        </g>`}getCss(){return"\n        \n        :host {\n            --natural-key-color: #FFFFFF; \n            --natural-key-outline-color: #555555;\n            \n            --sharp-key-color: #555555;\n            --sharp-key-outline-color: #555555;\n            \n            --depressed-key-color: #808080;\n            --depressed-key-transform: scale(1, 0.95);\n        }\n        \n        :host {\n          display: block;\n        }\n        \n        .natural-note {\n          stroke: var(--natural-key-outline-color);\n          fill: var(--natural-key-color);\n          width: 10px;\n          height: 50px;\n        }\n        \n        .sharp-note {\n          stroke: var(--sharp-key-outline-color);\n          fill: var(--sharp-key-color);\n          width: 6px;\n          height: 30px;\n        }\n        \n        .depressed {\n          fill: var(--depressed-key-color);\n          transform: var(--depressed-key-transform);\n        }\n        "}}const s=(t,e)=>`[data-note="${t}"][data-octave="${e}"]`;customElements.define("piano-keys",e)})?i.call(e,s,e,t):i)||(t.exports=n)},6811:(t,e,s)=>{"use strict";s(6226);var i=s(1260);function n(t){class e extends Error{constructor(){super("Invalid note name: "+t),this.name="NoteNameParseError",this.noteName=t}}function s(t){if("-"==t)throw new e;const s="C-D-EF-G-A-B".indexOf(t);if(-1==s)throw new e;return s}function i(t){const s="0123456789".indexOf(t);if(-1==s)throw new e;return 12*s}switch(t.length){case 2:return s(t[0])+i(t[1]);case 3:return s(t[0])+function(t){switch(t){case"b":return-1;case"#":return 1;default:throw new e}}(t[1])+i(t[2]);default:throw new e}}function a(t){return Math.floor(t/12)}function o(t){return t%12}const r=[0,2,4,5,7,9,11],h=[1,3,6,8,10];function l(t){return r.indexOf(o(t))>=0}function c(t){return h.indexOf(o(t))>=0}function d(t,e={}){const s=document.createElementNS("http://www.w3.org/2000/svg",t);for(const[t,i]of Object.entries(e))s.setAttribute(t,i);return s}const u=[1,18,25,42,49,73,90,97,114,121,138,145],p=class{constructor(t,e={}){let s=n(e.lowest||"A0");c(s)&&s--,s<0&&(s=0);let i=n(e.highest||"C8");if(c(i)&&i++,i<s)throw new RangeError("Highest note must not be lower than lowest note.");const r=e.keyStroke||"black",h=e.whiteKeyFill||"white";this._whiteKeyFill=h,this._whiteKeyHighlightFill=e.whiteKeyHighlightFill||"#00EA9C";const p=e.blackKeyFill||"black";this._blackKeyFill=p,this._blackKeyHighlightFill=e.blackKeyHighlightFill||"#00CC88";const m=[],f=[],g=[],y=168*a(s)+u[o(s)]-1;for(let t=s;t<=i;t++){const e=168*a(t)+u[o(t)]-y,s=l(t),i=d("rect",s?{x:e,y:1,width:24,height:140,rx:2,ry:2,stroke:r,"stroke-width":2,fill:h}:{x:e,y:1,width:14,height:90,rx:2,ry:2,stroke:r,"stroke-width":2,fill:p});m[t]=i,s?f.push(i):g.push(i)}this._keys=m;const v=d("svg",{viewBox:`0 0 ${2+24*f.length} 142`});for(const t of f)v.appendChild(t);for(const t of g)v.appendChild(t);t.appendChild(v)}fillKey(t,e){const s=n(t),i=this._keys[s];i&&i.setAttribute("fill",e||(l(s)?this._whiteKeyHighlightFill:this._blackKeyHighlightFill))}clearKey(t){const e=n(t),s=this._keys[e];s&&s.setAttribute("fill",l(e)?this._whiteKeyFill:this._blackKeyFill)}},m="EarTrainerUser";class f extends HTMLElement{constructor(){super(),this.addListeners(),this.storage=JSON.parse(localStorage.getItem(m))||{},this.inputs=this.querySelectorAll("input,select"),this.inputs.forEach((t=>{let e=t.getAttribute("name"),s=this.storage[e];s&&(t.value=s),t.dispatchEvent(new CustomEvent("change",{bubbles:!0})),this.set(e,t.value)}))}set(t,e){this.storage[t]=e,localStorage.setItem(m,JSON.stringify(this.storage))}get(t,e="normal"){return this.storage=JSON.parse(localStorage.getItem(m)),this[e](this.storage[t])}tempo(t){return 60/parseInt(t)}number(t){return parseInt(t)}float(t){return parseFloat(t)}array(t){return JSON.parse(t)}normal(t){return t}addListeners(){this.addEventListener("change",this.update.bind(this)),this.addEventListener("keyup",this.update.bind(this))}update(t){t.target.getAttribute("name")&&(this.set(t.target.getAttribute("name"),t.target.value),document.dispatchEvent(new CustomEvent("userupdate")))}}customElements.define("define-user",f);const g=document.getElementById("User"),y=document.getElementById("KeyCenter");document.addEventListener("userupdate",(function(){document.dispatchEvent(new CustomEvent("transpose"))}));const v=["C",["C#","Db"],"D",["D#","Eb"],"E","F",["F#","Gb"],"G",["G#","Ab"],"A",["A#","Bb"],"B"],b=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],w=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],E={notes:[b,b,w,b,w,b,b,w,b,w,b,w],transpose(t,e=y.value){return t=Array.isArray(t)?t:[t],e=parseInt(e),t.map((t=>this.notes[e][this.normalizeIndex(parseInt(t)+e)]))},noteNames(t,e=y.value){return t=Array.isArray(t)?t:[t],e=parseInt(e),t.map((t=>v[this.normalizeIndex(parseInt(t))]))},normalizeIndex:t=>t>11?t-12:t};class k extends HTMLElement{constructor(){super(),this.set=this.querySelector("#NoteSet"),this.setSelector=this.querySelectorAll("#NoteSet option"),document.dispatchEvent(new CustomEvent("transpose")),document.addEventListener("transpose",this.transposeSetSelector.bind(this)),this.transposeSetSelector()}transposeSetSelector(){let t,e=g.get("tonality"),s=[],i=[];this.setSelector.forEach(((n,a)=>{const o=/\{(.*?)}/gm;let r,h=n.getAttribute("data-template");for(;null!==(r=o.exec(h));)r.index===o.lastIndex&&o.lastIndex++,h=h.replaceAll(r[0],E.transpose([r[1]],y.value));n.innerText=h,this.set.value==n.value&&(t=n),-1==n.getAttribute("data-tonality").indexOf(e)?(i.push(n),n.classList.add("hidden")):(s.push(n),n.classList.remove("hidden"))})),i.indexOf(t)>-1&&(this.set.value=s[i.indexOf(t)].value,s[i.indexOf(t)].dispatchEvent(new CustomEvent("change",{bubbles:!0})))}}customElements.define("key-selector",k);const S=document.getElementById("piano"),C=new p(S,{lowest:`C${g.get("octave","number")}`,highest:`B${g.get("octave","number")}`});function x(t,e){[...t.classList].forEach((s=>{s.startsWith(e)&&t.classList.remove(s)}))}new class{constructor(t){this.piano=t,this.notesDown=[],this.handlePlay=this.play.bind(this),this.handleListen=this.listen.bind(this),this.playback=!0,this.piano.addEventListener("click",this.handlePlay),this.piano.addEventListener("click",this.handleListen),document.addEventListener("question:start",this.clear.bind(this)),this.setKeyNames(),this.synth=(new i.WV).toDestination(),document.addEventListener("transpose",this.setKeyNames.bind(this))}setKeyNames(){C._keys.forEach(((t,e)=>{let s=e-12*g.get("octave","number");t.setAttribute("data-note",E.noteNames(s))}))}async play(t){if(!this.playback)return;await i.BL();let e=t.target.getAttribute("data-note").split(",")[0],s=this.formatNote(e);this.synth.triggerAttackRelease(s,"8n")}listen(t){let e=t.target.getAttribute("data-note").split(","),s=!1,i=g.selected_notes||[];i.filter((t=>e.indexOf(t[0])>-1&&(s=t[0],!0)));let n=s?this.formatNote(s):this.formatNote(e[0]);s?(this.piano.removeEventListener("click",this.handlePlay),C.fillKey(n),this.notesDown.push(n),this.piano.addEventListener("click",this.handlePlay)):i.length>0?(C.fillKey(n,"rgba(185, 28, 28, 1)"),this.notesDown.push(n)):(C.fillKey(n,"#fbbf24"),setTimeout((function(){C.clearKey(n)}),300)),document.dispatchEvent(new CustomEvent("answer",{detail:n}))}clear(){this.notesDown.forEach((t=>{C.clearKey(t)}))}formatNote(t){return`${t}${g.get("octave","number")}`}}(S);const A=["green","pink","blue","purple","yellow"],L=["from","via","to"];class I extends HTMLElement{constructor(){super(),document.addEventListener("gameify:punish",this.reset.bind(this)),this.reset()}reset(){x(this,"from-"),x(this,"via-"),x(this,"to-");for(var t=[];t.length<3;){var e=Math.floor(Math.random()*A.length),s=A[e];-1===t.indexOf(s)&&t.push(s)}t=t.map(((t,e)=>`${L[e]}-${t}-500`)),this.classList.add(...t)}}customElements.define("fancy-background",I);class M extends HTMLElement{constructor(){super(),this.stopwatch=new class{constructor(){this.start=null,this.stop=null}startTimer(){if(this.stop)return this.start=this.stop,void(this.stop=null);this.start=Date.now()}stopTimer(){this.stop||(this.stop=Date.now())}reset(){this.start=null,this.stop=null}get getTimeElapsedInMs(){return null==this.start?0:null==this.stop?Date.now()-this.start:this.stop-this.start}get getSecondsElapsedIn60Seconds(){return Math.floor(this.getTimeElapsedInMs/1e3%60)}get getTimeElapsedInMinutes(){return Math.floor(this.getTimeElapsedInMs/1e3/60)}get getCurrentMillaSecondElapsedAsFraction(){return this.getTimeElapsedInMs%1e3/1e3}get getTimeElapsedInStopWatchFormatString(){let t=String(this.getTimeElapsedInMinutes),e=t.length>1?t:"0"+t,s=String(this.getSecondsElapsedIn60Seconds);return`${e}:${s.length>1?s:"0"+s}:${"0"+String(Math.floor(10*this.getCurrentMillaSecondElapsedAsFraction))}`}},this.display=this.querySelector("[data-time]"),this.face=this.querySelector("[data-face]"),this.limit=this.querySelector("[data-limit]"),this.timelimit=function(){return g.get("timelimit","float")*g.get("note_count","number")},this.timelimitInMs=function(){return 1e3*this.timelimit()*g.get("note_count","number")},document.addEventListener("gameify:afternotes",this.start.bind(this)),document.addEventListener("gameify:afteranswer",this.stop.bind(this)),document.addEventListener("gameify:pause",this.stop.bind(this)),document.addEventListener("userupdate",this.update.bind(this)),window.addEventListener("blur",this.stop.bind(this)),this.update()}start(){this.stop(),this.reset(),this.stopwatch.startTimer(),this.currentLimit=this.timelimitInMs(),this.refreshRate=setInterval(this.refresh.bind(this),10),this.face.classList.add("bg-success"),this.status="success"}stop(){this.isPaused=!0,this.stopwatch.stopTimer(),clearInterval(this.refreshRate)}reset(){this.stopwatch.reset(),x(this.face,"bg-")}refresh(){this.display.innerText=`${(this.stopwatch.getTimeElapsedInMs/1e3).toFixed(2)}s`,this.stopwatch.getTimeElapsedInMs>this.currentLimit&&"fail"!=this.status&&(x(this.face,"bg-"),this.face.classList.add("bg-fail"),this.status="fail",document.dispatchEvent(new CustomEvent("gameify:punish")))}update(){this.limit.innerText=`${this.timelimit()}s`}}customElements.define("stopwatch-timer",M),document.getElementById("Stopwatch"),Gameify;const N=new i.v2(i.WV).toDestination();async function P(t,e){await i.BL();const s=e?e+i.zO():i.zO();let n=0;t.forEach((t=>{let e=t.duration*g.get("bpm","tempo");t.sequence.forEach((t=>{N.triggerAttackRelease(t,e,s+n)})),n+=e}))}function T(t){return E.transpose(t).map((t=>`${t}${g.get("octave","number")}`))}const F=[[0,4,7],[0,5,9],[2,7,11],[0,4,7]],B=[[0,3,7],[0,5,8],[2,7,11],[0,3,7]];let O=function(){switch(g.get("tonality")){case"major":default:return F;case"minor":return B}},j=()=>[{sequence:T(O()[0]),duration:2},{sequence:T(O()[1]),duration:1},{sequence:T(O()[2]),duration:1},{sequence:T(O()[3]),duration:2}];function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function q(t,e,s){return e&&D(t.prototype,e),s&&D(t,s),t}function K(t){return+t.replace(/px/,"")}function _(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Math.random()*(e-t)+t;return Math.floor(i*Math.pow(10,s))/Math.pow(10,s)}function R(t){return t[_(0,t.length)]}var H=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function U(t){return Math.log(t)/Math.log(1920)}var z=function(){function t(e){$(this,t);var s=e.initialPosition,i=e.direction,n=e.confettiRadius,a=e.confettiColors,o=e.emojis,r=e.emojiSize,h=e.canvasWidth,l=_(.9,1.7,3)*U(h);this.confettiSpeed={x:l,y:l},this.finalConfettiSpeedX=_(.2,.6,3),this.rotationSpeed=o.length?.01:_(.03,.07,3)*U(h),this.dragForceCoefficient=_(5e-4,9e-4,6),this.radius={x:n,y:n},this.initialRadius=n,this.rotationAngle="left"===i?_(0,.2,3):_(-.2,0,3),this.emojiSize=r,this.emojiRotationAngle=_(0,2*Math.PI),this.radiusYUpdateDirection="down";var c="left"===i?_(82,15)*Math.PI/180:_(-15,-82)*Math.PI/180;this.absCos=Math.abs(Math.cos(c)),this.absSin=Math.abs(Math.sin(c));var d=_(-150,0),u={x:s.x+("left"===i?-d:d)*this.absCos,y:s.y-d*this.absSin};this.currentPosition=Object.assign({},u),this.initialPosition=Object.assign({},u),this.color=o.length?null:R(a),this.emoji=o.length?R(o):null,this.createdAt=(new Date).getTime(),this.direction=i}return q(t,[{key:"draw",value:function(t){var e=this.currentPosition,s=this.radius,i=this.color,n=this.emoji,a=this.rotationAngle,o=this.emojiRotationAngle,r=this.emojiSize,h=window.devicePixelRatio;i?(t.fillStyle=i,t.beginPath(),t.ellipse(e.x*h,e.y*h,s.x*h,s.y*h,a,0,2*Math.PI),t.fill()):n&&(t.font="".concat(r,"px serif"),t.save(),t.translate(h*e.x,h*e.y),t.rotate(o),t.textAlign="center",t.fillText(n,0,0),t.restore())}},{key:"updatePosition",value:function(t,e){var s=this.confettiSpeed,i=this.dragForceCoefficient,n=this.finalConfettiSpeedX,a=this.radiusYUpdateDirection,o=this.rotationSpeed,r=this.createdAt,h=this.direction,l=e-r;s.x>n&&(this.confettiSpeed.x-=i*t),this.currentPosition.x+=s.x*("left"===h?-this.absCos:this.absCos)*t,this.currentPosition.y=this.initialPosition.y-s.y*this.absSin*l+.00125*Math.pow(l,2)/2,this.rotationSpeed-=this.emoji?1e-4:1e-5*t,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji?this.emojiRotationAngle+=this.rotationSpeed*t%(2*Math.PI):"down"===a?(this.radius.y-=t*o,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=t*o,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(t){return this.currentPosition.y<t+100}}]),t}();function G(){var t=document.createElement("canvas");return t.style.position="fixed",t.style.width="100%",t.style.height="100%",t.style.top="0",t.style.left="0",t.style.zIndex="1000",t.style.pointerEvents="none",document.body.appendChild(t),t}function W(t){var e=t.confettiRadius,s=void 0===e?6:e,i=t.confettiNumber,n=void 0===i?t.confettiesNumber||(t.emojis?40:250):i,a=t.confettiColors,o=void 0===a?H:a,r=t.emojis,h=void 0===r?t.emojies||[]:r,l=t.emojiSize,c=void 0===l?80:l;return t.emojies&&console.error("emojies argument is deprecated, please use emojis instead"),t.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead"),{confettiRadius:s,confettiNumber:n,confettiColors:o,emojis:h,emojiSize:c}}const J=new(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$(this,t),this.canvas=e.canvas||G(),this.canvasContext=this.canvas.getContext("2d"),this.shapes=[],this.lastUpdated=(new Date).getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return q(t,[{key:"loop",value:function(){var t,e,s,i,n,a=this;t=this.canvas,e=window.devicePixelRatio,i=K((s=getComputedStyle(t)).getPropertyValue("width")),n=K(s.getPropertyValue("height")),t.setAttribute("width",(i*e).toString()),t.setAttribute("height",(n*e).toString());var o=(new Date).getTime(),r=o-this.lastUpdated,h=this.canvas.offsetHeight;this.shapes.forEach((function(t){t.updatePosition(r,o),t.draw(a.canvasContext)})),this.iterationIndex%100==0&&(this.shapes=this.shapes.filter((function(t){return t.getIsVisibleOnCanvas(h)}))),this.lastUpdated=o,this.iterationIndex++,requestAnimationFrame(this.loop)}},{key:"addConfetti",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=W(t),s=e.confettiRadius,i=e.confettiNumber,n=e.confettiColors,a=e.emojis,o=e.emojiSize,r=window.devicePixelRatio,h=this.canvas.width/r,l=this.canvas.height/r,c=5*l/7,d={x:0,y:c},u={x:h,y:c},p=0;p<i/2;p++)this.shapes.push(new z({initialPosition:d,direction:"right",confettiRadius:s,confettiColors:n,confettiNumber:i,emojis:a,emojiSize:o,canvasWidth:h})),this.shapes.push(new z({initialPosition:u,direction:"left",confettiRadius:s,confettiColors:n,confettiNumber:i,emojis:a,emojiSize:o,canvasWidth:h}))}}]),t}());class V extends HTMLElement{constructor(){super(),this.streak=0,this.correct=0,this.total=0,this.late=0,this.fire=10,this.elements={streak:this.querySelector("[data-streak]"),correct:this.querySelector("[data-correct]"),total:this.querySelector("[data-total]"),late:this.querySelector("[data-late]"),gradient:this.querySelector("[data-gradient"),background:document.getElementById("background")},document.addEventListener("gameify:update",this.update.bind(this)),document.addEventListener("gameify:reward",this.reward.bind(this)),document.addEventListener("gameify:punish",this.punish.bind(this))}update(){this.elements.streak.innerText=this.streak,this.elements.correct.innerText=this.correct,this.elements.total.innerText=this.total,this.elements.gradient.style.width=this.correct/this.total*100+"%";let t=this.streak/this.fire;this.elements.background.style.opacity=t>=1?1:t,0==t?document.dispatchEvent(new CustomEvent("gameify:punish")):t>=1&&document.dispatchEvent(new CustomEvent("gameify:reward",{detail:{ratio:t,is_threshold:function(){return t>=1&&t==parseInt(t)}}}))}reward(t){let e=t.detail.ratio;t.detail.is_threshold()&&(1==e?J.addConfetti():J.addConfetti({emojis:["🔥","💥"]}))}punish(t){x(this.elements.background,"duration-"),this.elements.background.style.opacity=0,setTimeout((()=>{this.elements.background.classList.add("duration-1000")}),1e3)}}customElements.define("game-area",V);const Y=document.getElementById("Gameify"),X=document.getElementById("Stopwatch");new class{constructor(){this.handleAnswer=this.registerAnswer.bind(this),this.playBtn=document.querySelector("#Play"),this.playBtn?.addEventListener("click",this.play.bind(this)),this.cadenceBtn=document.querySelector("#PlayCadence"),this.cadenceBtn?.addEventListener("click",this.playCadence.bind(this)),this.notesBtn=document.querySelector("#PlayNotes"),this.notesBtn?.addEventListener("click",function(){this.playNotes(0)}.bind(this))}play(){if(this.playBtn.isPlaying)return void this.pause();this.playCadence(),document.addEventListener("answer",this.handleAnswer),document.dispatchEvent(new CustomEvent("question:start"));let t=E.transpose(g.get("set","array"));g.notes=function(t=1,e=["C","D","E","F","G","A","B"]){let s=[];for(;s.length<t;){var i=Math.floor(Math.random()*e.length);-1===s.indexOf(e[i])&&s.push(e[i])}return s}(g.get("note_count","number"),t),g.selected_notes=this.setOctaves(JSON.parse(JSON.stringify(g.notes))),g.notes=this.setOctave(g.notes),this.setButtonState("PAUSE","bg-yellow-gradient",!0),this.playNotes(),setTimeout((()=>{this.playBtn.isPlaying&&document.dispatchEvent(new CustomEvent("gameify:afternotes"))}),1e3*this.offset)}playCadence(){this.playingCadence||(this.playingCadence=!0,this.offset=(P(j()),function(t){let e=0;return t.forEach((t=>e+=t.duration*g.get("bpm","tempo"))),e}(j())),setTimeout(function(){this.playingCadence=!1}.bind(this),1e3*this.offset))}playNotes(t=this.offset){g.selected_notes&&P([{sequence:g.selected_notes.map((t=>t.join(""))),duration:1}],t)}pause(){this.setButtonState("PLAY","bg-green-gradient",!1),document.dispatchEvent(new CustomEvent("gameify:pause"))}setButtonState(t,e,s){x(this.playBtn,"bg-"),this.playBtn.classList.add(e),this.playBtn.innerText=t,this.playBtn.isPlaying=s}setOctave(t){return t.map((t=>`${t}${g.get("octave","number")}`))}setOctaves(t){return t.map((t=>[t,`${g.get("octave","number")+Math.floor(Math.random()*g.get("spread","number"))}`]))}registerAnswer(t){if(-1==g.notes.indexOf(t.detail))return Y.streak=0,Y.total+=1,void this.dispatchUpdateEvent();"success"==X.status&&(Y.streak+=1,Y.correct+=1),"fail"==X.status&&(Y.streak=0,Y.late+=1),Y.total+=1,this.dispatchUpdateEvent(),g.notes.splice(g.notes.indexOf(t.detail),1),0==g.notes.length&&(document.removeEventListener("answer",this.handleAnswer),document.dispatchEvent(new CustomEvent("gameify:afteranswer")),this.setButtonState("PLAY","bg-green-gradient",!1),setTimeout(this.play.bind(this),350))}dispatchUpdateEvent(){document.dispatchEvent(new CustomEvent("gameify:update"))}}}},t=>{t.O(0,[675,807],(()=>(6811,t(t.s=6811)))),t.O()}]);